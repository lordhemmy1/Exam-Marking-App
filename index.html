<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Examination Marking App</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <header class="bg-primary text-white text-center p-3 mb-4">Examination Marking App</header>

  <div class="container-fluid">
    <div class="row mb-3">
      <div class="col-12 d-flex justify-content-center">
        <button class="tab-button btn btn-outline-primary me-2 active" data-tab="answer">Teacher's Answer Tab</button>
        <button class="tab-button btn btn-outline-primary me-2" data-tab="db">Students Database</button>
        <button class="tab-button btn btn-outline-primary me-2" data-tab="mark">Marking Tab</button>
        <button class="tab-button btn btn-outline-primary" data-tab="score">Score Tab</button>
      </div>
    </div>

    <!-- Teacher's Answer Tab -->
    <section id="answer" class="tab-content active">
      <div class="card p-3 mb-4">
        <h3>Objective Answer Form</h3>
        <form id="objective-answer-form" class="row g-3"></form>
        <div id="objective-key-total" class="fw-bold mt-2" style="display:none;"></div>
        <div class="upload-note mb-2">Expected file upload format: Column A – Question No.; Column B – Correct Answer.</div>
        <input type="file" id="upload-objective-answer" class="form-control mb-4" accept=".xlsx,.csv" />

        <h3>Essay Answer Form</h3>
        <form id="essay-answer-form" class="row g-3 mb-2"></form>
        <div id="essay-key-total" class="fw-bold mt-2" style="display:none;"></div>
        <div class="upload-note mb-2">Expected file upload format: Column A – Question No.; Column B – Mark; Column C – Answer.</div>
        <input type="file" id="upload-essay-answer" class="form-control mb-3" accept=".xlsx,.csv" />

        <button type="button" id="save-answers-btn" class="btn btn-primary">Save Answers</button>
      </div>
    </section>

    <!-- Students Database Tab -->
    <section id="db" class="tab-content">
      <div class="card p-3 mb-4">
        <h3>Students Database</h3>
        <form id="db-student-form" class="row g-3">
          <div class="col-md-4">
            <label class="form-label">Name:</label>
            <input type="text" id="db-student-name" class="form-control" />
          </div>
          <div class="col-md-8">
            <label class="form-label d-block">Level:</label>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="level" value="primary" />
              <label class="form-check-label">Primary</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="level" value="secondary" />
              <label class="form-check-label">Secondary</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="level" value="tertiary" />
              <label class="form-check-label">Tertiary</label>
            </div>
          </div>
          <div class="col-md-4">
            <label class="form-label">Class:</label>
            <select id="db-student-class" class="form-select">
              <option value="">Select Class</option>
            </select>
          </div>
          <div class="col-md-4">
            <label class="form-label">Arm:</label>
            <input type="text" id="db-student-arm" class="form-control" placeholder="Enter Arm e.g Science, Business…" />
          </div>
          <div class="col-md-12">
            <fieldset class="border p-2">
              <legend class="w-auto">Objective Answers (comma-separated)</legend>
              <textarea id="db-objective-answer" class="form-control" placeholder="E.g. A,B,C,..."></textarea>
            </fieldset>
          </div>
          <div class="col-md-12">
            <fieldset class="border p-2">
              <legend class="w-auto">Essay Answers</legend>
              <div id="db-essay-form"></div>
            </fieldset>
          </div>
          <div class="col-12">
            <button type="button" id="save-student-btn" class="btn btn-success me-2">Add Student</button>
            <button type="button" id="update-student-btn" class="btn btn-primary" style="display:none;">Update Student</button>
          </div>
        </form>
        <h4 class="mt-4">Student Information</h4>
        <div id="student-db-reference"></div>
        <button type="button" id="clear-students-btn" class="btn btn-danger mt-3">Clear Database</button>
      </div>
    </section>

    <!-- Marking Tab -->
    <section id="mark" class="tab-content">
      <div class="card p-3 mb-4">
        <h3>Student Information</h3>
        <div id="student-search-container" class="d-flex gap-2 mb-3">
          <label for="search-student-input" class="form-label">Search Student</label>
          <input type="text" id="search-student-input" class="form-control" placeholder="Enter student name" />
          <button type="button" id="search-student-btn" class="btn btn-primary">Search</button>
          <button type="button" id="mark-next-btn" class="btn btn-secondary">Mark Next Student</button>
        </div>
        <form id="student-info-form" class="row g-3 mb-4">
          <div class="col-md-4">
            <label class="form-label">Name:</label>
            <input type="text" id="mark-student-name" class="form-control" readonly />
          </div>
          <div class="col-md-4">
            <label class="form-label">Class:</label>
            <input type="text" id="mark-student-class" class="form-control" readonly />
          </div>
          <div class="col-md-4">
            <label class="form-label">Arm:</label>
            <input type="text" id="mark-student-arm" class="form-control" readonly />
          </div>
        </form>

        <h3>Student Objective Answers</h3>
        <button type="button" id="populate-objective-btn" class="btn btn-info mb-2">Populate Objective Answers</button>
        <form id="objective-marking-form" class="row g-3 mb-2"></form>
        <button type="button" id="mark-objective-btn" class="btn btn-warning mb-3">Mark Objective</button>
        <div id="objective-marking-details" class="fw-bold mb-4"></div>

        <h3>Student Essay Answers</h3>
        <div id="essay-marking-container" class="mb-3"></div>
        <button type="button" id="sum-essay-btn" class="btn btn-dark mb-2">Sum Essay Marks</button>
        <div id="essay-scoring-details" class="fw-bold mb-4"></div>

        <button type="button" id="record-mark-btn" class="btn btn-success">Record Mark</button>
        <div id="marking-notification" class="mt-2 text-success"></div>
      </div>
    </section>

    <!-- Score Tab -->
    <section id="score" class="tab-content">
      <div class="card p-3 mb-4">
        <h3>Scores</h3>
        <div class="table-responsive">
          <table id="score-table" class="table table-striped">
            <thead class="thead-dark">
              <tr>
                <th>Name</th>
                <th>Class</th>
                <th>Arm</th>
                <th>Objective</th>
                <th>Essay</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="d-flex gap-2">
          <button onclick="resetScores()" class="btn btn-danger">Reset Scores</button>
          <button type="button" id="download-score-btn" class="btn btn-primary">Download Scores</button>
          <button onclick="resetAllData()" id="reset-all-btn" class="btn btn-warning">Reset All</button>
        </div>
      </div>
    </section>
  </div>

  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
