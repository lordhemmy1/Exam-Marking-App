<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Exam Marking App</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- SheetJS for XLSX/CSV -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <!-- Tesseract.js for OCR -->
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.1.4/dist/tesseract.min.js"></script>
</head>
<body>
  <header>Examination Marking App</header>
  <nav>
    <button class="tab-button active" data-tab="answer">Answer Tab</button>
    <button class="tab-button" data-tab="studentDB">Students Database</button>
    <button class="tab-button" data-tab="marking">Marking Tab</button>
    <button class="tab-button" data-tab="score">Score Tab</button>
  </nav>

  <!-- Answer Tab -->
  <section id="answer" class="tab-content active">
    <h3>Objective Answer Form</h3>
    <div id="objective-answer-container">
      <form id="objective-answer-form"></form>
      <div class="upload-note">
        Expected file upload format: Column A – Question No.; Column B – Correct Answer.
      </div>
      <input type="file" id="upload-objective-answer" accept=".xlsx,.csv" />
    </div>
    <br>
    <h3>Essay Answer Form</h3>
    <div id="essay-answer-container">
      <form id="essay-answer-form"></form>
      <div class="upload-note">
        Expected file upload format: Column A – Question No.; Column B – Mark; Column C – Answer.
      </div>
      <input type="file" id="upload-essay-answer" accept=".xlsx,.csv" />
    </div>
    <br>
    <button type="button" onclick="saveAnswerData()">Save Answer Data</button>
  </section>

  <!-- Students Database Tab -->
  <section id="studentDB" class="tab-content">
    <h3>Students Database</h3>
    <form id="db-student-form">
      <fieldset>
        <legend>Student Information</legend>
        <div><label>Name:</label><input type="text" id="db-student-name" /></div>
        <div><label>Class:</label><input type="text" id="db-student-class" /></div>
        <div><label>Arm:</label><input type="text" id="db-student-arm" /></div>
      </fieldset>

      <fieldset>
        <legend>Objective Answer (comma‑separated)</legend>
        <textarea id="db-objective-answer" placeholder="E.g. A,B,C,..."></textarea>
      </fieldset>

      <fieldset>
        <legend>Essay Answers</legend>
        <div id="db-essay-form"></div>
      </fieldset>

      <button type="button" onclick="saveStudentData()">Save Student</button>
    </form>

    <div id="student-db-reference"></div>
  </section>

  <!-- Marking Tab -->
  <section id="marking" class="tab-content">
    <h3>Load Student for Marking</h3>
    <form id="student-info-form">
      <div><label>Name:</label><input type="text" id="student-name" /></div>
      <div><label>Class:</label><input type="text" id="student-class" /></div>
      <div><label>Arm:</label><input type="text" id="student-arm" /></div>
      <button type="button" id="upload-student-btn">Upload Student</button>
    </form>

    <h3>Objective Marking</h3>
    <form id="objective-marking-form"></form>
    <button type="button" id="mark-objective-btn" onclick="markObjectiveOnly()">Mark Objective</button>
    <div id="objective-marking-details"></div>

    <h3>Essay Marking</h3>
    <form id="essay-marking-form"></form>
    <button type="button" onclick="finalizeMarking()">Finalize & Transfer to Scores</button>
    <div id="marking-notification"></div>
  </section>

  <!-- Score Tab -->
  <section id="score" class="tab-content">
    <h3>Score Tab</h3>
    <table id="score-table">
      <thead>
        <tr>
          <th>Name</th><th>Class</th><th>Arm</th>
          <th>Objective</th><th>Essay</th><th>Total</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <div class="score-controls">
      <button onclick="resetScores()">Reset Scores</button>
      <button onclick="downloadScores('csv')">Download CSV</button>
      <button onclick="downloadScores('xlsx')">Download XLSX</button>
      <button onclick="downloadScores('doc')">Download DOC</button>
      <br><br>
      <button onclick="resetAllData()" style="background: darkred; color: white;">
        Reset All
      </button>
    </div>
  </section>

  <script src="script.js"></script>
</body>
</html>        </html>
